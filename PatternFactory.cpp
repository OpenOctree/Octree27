/*
* PatternsDefault.cpp
*
*  Created on: May 18, 2012
*      Author: jsepulve
*/

#include "PatternFactory.h"

using namespace std;

namespace patterns {
   PatternFactory* PatternFactory::m_Instance = NULL;
   int PatternFactory::m_NumInstances = 0;

   // template = array_index
   // T0   = 0
   // T2   = 1
   // T3   = 2
   // T4   = 3
   // T40  = 4
   // T4B  = 5
   // T4C  = 6
   // T4Cb = 7
   // T5A  = 8
   // T6   = 9
   // T6B  = 10
   // T7   = 11
   // T8   = 12
   const map<Uint, Uint> PatternFactory::pattern_template_map_newest = {
      // None: 1, 2B, 2C, 3C, 4F
      // T2
      {9, 1},      // 2A --> T2   [ 0 3 ]
      {73, 1},     // 3B --> T2   [ 0 3 6 ]
      // T3
      {11, 2},     // 3A --> T3   [ 0 1 3 ]
      {75, 2},     // 4D --> T3   [ 0 1 3 6 ]
      // T4
      {15, 3},     // 4A --> T4   [ 0 1 3 2 ]
      // T40
      {195, 4},    // 4E --> T40  [ 0 1 7 6 ]
      // T4B
      {27, 5},     // 4B --> T4B  [0 1 3 4]
      // T4C
      {139, 6},    // 4C --> T4C  [0 1 3 7]
      // T4C.b
      {29, 7},     // 4Cb--> T4Cb [0 2 3 4]
      // T5A
      {31, 8},     // 5A --> T5A  [ 0 1 2 3 4 ]
      // T6
      {93, 9},     // 5B --> T6   [ 0 3 2 4 6 ]
      {221, 9},    // 6A --> T6   [ 0 3 2 4 7 6 ]
      // T6B
      {95, 10},    // 6B --> T6B  [0 1 2 3 4 6]
      // T7
      {191, 11},   //  7 --> T7   [ 0 1 2 3 4 5 7 ]
/* remove_T8 */
      // T8
      {173, 12},   // 5C --> T8   [ 0 3 2 5 7 ]
      {235, 12},   // 6C --> T8   [ 0 1 3 5 7 6 ]
      {255, 12},   //  8 --> T8   [ 0 1 2 3 4 5 6 7 ]
/* /remove_T8 */
   };

   // Table from ito et. al (2009) efficient...
   const map<Uint, Uint> PatternFactory::pattern_template_map_ito = {
      // None: 1, 2B, 2C, 3C, 4F
      // T2
      {9, 1},      // 2A --> T2   [ 0 3 ]
      {73, 1},     // 3B --> T2   [ 0 3 6 ]
      // T3
      {11, 2},     // 3A --> T3   [ 0 1 3 ]
      {75, 2},     // 4D --> T3   [ 0 1 3 6 ]
      // T4
      {15, 3},     // 4A --> T4   [ 0 1 3 2 ]
      // T40
      {195, 4},    // 4E --> T40  [ 0 1 7 6 ]
      // T6
      {141, 9},    // 4B --> T6   [ 0 2 3 7 ]
      {77, 9},     // 4C --> T6   [ 0 2 3 6 ]
      {205, 9},    // 5A --> T6   [ 0 2 3 6 7 ]
      {93, 9},     // 5B --> T6   [ 0 3 2 4 6 ]
      {221, 9},    // 6A --> T6   [ 0 3 2 4 7 6 ]
/* remove_T8 */
      // T8
      {173, 12},   // 5C --> T8   [ 0 3 2 5 7 ]
      {95, 12},    // 6B --> T8   [ 0 1 2 3 4 6 ]
      {235, 12},   // 6C --> T8   [ 0 1 3 5 7 6 ]
      {191, 12},   //  7 --> T8   [ 0 1 2 3 4 5 7 ]
      {255, 12}    //  8 --> T8   [ 0 1 2 3 4 5 6 7 ]
/* /remove_T8 */
   };

   // Table from ito et. al (2009) Octree-based reasonable-quality hexahedral mesh...
   const map<Uint, Uint> PatternFactory::pattern_template_map_ito_A = {
      // T2
      {9, 1},      // 2A --> T2   [ 0 3 ]
      // T3
      {10, 2},     // 2B --> T3   [ 1 3 ] //INFO Dada la forma en q se buscan patrones; este caso no deberia aparecer nunca.
      {11, 2},     // 3A --> T3   [ 0 1 3 ]
      // T4
      {15, 3},     // 4A --> T4   [ 0 1 3 2 ]
      // T6
      {65, 9},     // 2C --> T6   [ 0 6 ]
      {81, 9},     // 3B --> T6   [ 0 4 6 ]
      {88, 9},     // 3C --> T6   [ 3 4 6 ]
      {141, 9},    // 4B --> T6   [ 0 2 3 7 ]
      {77, 9},     // 4C --> T6   [ 0 2 3 6 ]
      {149, 9},    // 4D --> T6   [ 0 2 4 7 ]
      {85, 9},     // 4E --> T6   [ 0 2 4 6 ]
      {205, 9},    // 5A --> T6   [ 0 2 3 6 7 ]
      {93, 9},     // 5B --> T6   [ 0 3 2 4 6 ]
      {221, 9},    // 6A --> T6   [ 0 3 2 4 7 6 ]
/* remove_T8 */
      // T8
      {90, 12},    // 4F --> T8   [ 1 3 4 6 ]
      {173, 12},   // 5C --> T8   [ 0 3 2 5 7 ]
      {95, 12},    // 6B --> T8   [ 0 1 2 3 4 6 ]
      {235, 12},   // 6C --> T8   [ 0 1 3 5 7 6 ]
      {191, 12},   //  7 --> T8   [ 0 1 2 3 4 5 7 ]
      {255, 12},   //  8 --> T8   [ 0 1 2 3 4 5 6 7 ]
/* /remove_T8 */
   };

   const map<Uint, Uint> PatternFactory::pattern_template_map_ito_B = {
      // T2
      {9, 1},      // 2A --> T2   [ 0 3 ]
      {73, 1},     // 3B --> T2   [ 0 3 6 ]
      // T3
      {11, 2},     // 3A --> T3   [ 0 1 3 ]
      {75, 2},     // 4D --> T3   [ 0 1 3 6 ]
      // T4
      {15, 3},     // 4A --> T4   [ 0 1 3 2 ]
      // T6
      {141, 9},    // 4B --> T6   [ 0 2 3 7 ]
      {77, 9},     // 4C --> T6   [ 0 2 3 6 ]
      {85, 9},     // 4E --> T6   [ 0 2 4 6 ]
      {205, 9},    // 5A --> T6   [ 0 2 3 6 7 ]
      {93, 9},     // 5B --> T6   [ 0 3 2 4 6 ]
      {221, 9},    // 6A --> T6   [ 0 3 2 4 7 6 ]
/* remove_T8 */
      // T8
      {173, 12},   // 5C --> T8   [ 0 3 2 5 7 ]
      {95, 12},    // 6B --> T8   [ 0 1 2 3 4 6 ]
      {235, 12},   // 6C --> T8   [ 0 1 3 5 7 6 ]
      {191, 12},   //  7 --> T8   [ 0 1 2 3 4 5 7 ]
      {255, 12},   //  8 --> T8   [ 0 1 2 3 4 5 6 7 ]
/* /remove_T8 */
   };

//                      4----------------------7
//                     /                      /
//                    /                      /   
//                   /                      /
//                  /                      /
//                 /                      /
//                /                      /
//               /                      /
//              /                      /
//             5----------------------6
//                      ------45-------47-------
//                     /     /        /|      /
//                    /     /        / |     /   
//                   /     /        /  |    /
//                  /     /        /   |   /
//                 /     /        /    |  /
//                /     61-------63    | /
//               /       |        |    |/
//              /        |        |    /
//              -----------------------|
//                      -|--------|----|-------
//                     / |        |    |      /
//                    /  |        |    |     /   
//                   /   |        |    |    /
//                  /    |        |    |   /
//                 /     |        |    |  /
//                /      |        |    | /
//               /       |        |    |/
//              /        |        |    /          
//              ---------------------- |         
//                      0|---10---|---11-------3
//                     / |   /    |   /       /   
//                    /  |  /     |  /       /   
//                   /   | /      | /       /
//                  /    |/       |/       /
//                 /     /        /       /
//                /     33-------35      /
//               /                      /
//              /                      /
//             1----------------------2

   /// Templates (o patrones de transicion)
   const PatternFactory::Template_st PatternFactory::templates[] = {
      { // T0 -> simple Cube; for testing
         0, {
            {HEXA_POINTS, {0, 1, 2, 3, 4, 5, 6, 7}}
         }
      },
      { // T2
         1, {
            {HEXA_POINTS, {10,33,35,11,45,61,63,47}},
            {HEXA_POINTS, {0,1,33,10,4,5,61,45}},
            {HEXA_POINTS, {33,1,2,35,61,5,6,63}},
            {HEXA_POINTS, {11,35,2,3,47,63,6,7}},
            {HEXA_POINTS, {45,61,63,47,4,5,6,7}}
         }
      },
      { // T3
         2, {
            //Hexa {33 32 0 1  61 60 4 5}
            {HEXA_POINTS, {0, 8, 64, 32, 4, 41, 173, 60}},
            {HEXA_POINTS, {8, 9, 65, 64, 41, 43, 175, 173}},
            {HEXA_POINTS, {9, 1, 33, 65, 43, 5, 61, 175}},
            {HEXA_POINTS, {64, 65, 33, 32, 173, 175, 61, 60}},
            {HEXA_POINTS, {41, 43, 175, 173, 4, 5, 61, 60}},
            //Hexa {3 0 32 34 7 4 60 62}
            {HEXA_POINTS, {10, 0, 32, 66, 45, 4, 60, 189}},
            {HEXA_POINTS, {11, 10, 66, 67, 47, 45, 189, 191}},
            {HEXA_POINTS, {3, 11, 67, 34, 7, 47, 191, 62}},
            {HEXA_POINTS, {67, 66, 32, 34, 191, 189, 60, 62}},
            {HEXA_POINTS, {47, 45, 189, 191, 7, 4, 60, 62}},
            //otros
            {HEXA_POINTS, {35, 33, 1, 2, 63, 61, 5, 6}},
            {HEXA_POINTS, {2, 3, 34, 35, 6, 7, 62, 63}},
            {HEXA_POINTS, {60, 61, 63, 62, 4, 5, 6, 7}},
            {HEXA_POINTS, {32, 33, 35, 34, 60, 61, 63, 62}}
         }
      },
      { // T4
         3, {
            {HEXA_POINTS, {41,43,55,53,4,5,6,7}},
            {HEXA_POINTS, {56,57,59,58,41,43,55,53}},
            {HEXA_POINTS, {45,56,58,47,4,41,53,7}},
            {HEXA_POINTS, {49,51,59,57,5,6,55,43}},

            {HEXA_POINTS, {0,8,32,10,4,41,56,45}},
            {HEXA_POINTS, {8,9,33,32,41,43,57,56}},
            {HEXA_POINTS, {9,1,12,33,43,5,49,57}},
            {HEXA_POINTS, {33,12,13,35,57,49,51,59}},
            {HEXA_POINTS, {32,33,35,34,56,57,59,58}},
            {HEXA_POINTS, {10,32,34,11,45,56,58,47}},
            {HEXA_POINTS, {11,34,14,3,47,58,53,7}},
            {HEXA_POINTS, {34,35,15,14,58,59,55,53}},
            {HEXA_POINTS, {35,13,2,15,59,51,6,55}}
         }
      },
      { // T40
         4, {
            // Otros
            {HEXA_POINTS, {56, 57, 59, 58, 60, 61, 63, 62}},
            {HEXA_POINTS, {59, 57, 1, 2, 63, 61, 5, 6}},
            {HEXA_POINTS, {3, 0, 56, 58, 7, 4, 60, 62}},
            //Hexa {0 1 2 3 56 57 59 58}
            {HEXA_POINTS, {3, 0, 8, 34, 58, 56, 112, 142}},
            {HEXA_POINTS, {34, 8, 9, 35, 142, 112, 113, 143}},
            {HEXA_POINTS, {35, 9, 1, 2, 143, 113, 57, 59}},
            {HEXA_POINTS, {142, 112, 113, 143, 58, 56, 57, 59}},
            {HEXA_POINTS, {34, 35, 2, 3, 142, 143, 59, 58}},
            //Hexa {60 61 63 62 4 5 6 7}
            {HEXA_POINTS, {60, 61, 63, 62, 156, 157, 127, 126}},
            {HEXA_POINTS, {60, 61, 157, 156, 4, 5, 37, 36}},
            {HEXA_POINTS, {62, 60, 156, 126, 7, 4, 36, 22}},
            {HEXA_POINTS, {156, 157, 127, 126, 36, 37, 23, 22}},
            {HEXA_POINTS, {127, 157, 61, 63, 23, 37, 5, 6}},
            //Hexa {57 56 0 1 61 60 4 5}
            {HEXA_POINTS, {0, 8, 112, 56, 4, 41, 173, 60}},
            {HEXA_POINTS, {8, 9, 113, 112, 41, 43, 175, 173}},
            {HEXA_POINTS, {9, 1, 57, 113, 43, 5, 61, 175}},
            {HEXA_POINTS, {112, 113, 57, 56, 173, 175, 61, 60}},
            {HEXA_POINTS, {41, 43, 175, 173, 4, 5, 61, 60}},
            //Hexa {2 3 58 59 6 7 62 63}
            {HEXA_POINTS, {58, 59, 2, 3, 220, 222, 54, 52}},
            {HEXA_POINTS, {58, 220, 52, 3, 62, 126, 22, 7}},
            {HEXA_POINTS, {222, 59, 2, 54, 127, 63, 6, 23}},
            {HEXA_POINTS, {220, 222, 54, 52, 126, 127, 23, 22}},
            {HEXA_POINTS, {58, 59, 222, 220, 62, 63, 127, 126}}
         }
      },
      { // T4B
         5, {
            // Otros
            {HEXA_POINTS, {56, 57, 59, 58, 60, 61, 63, 62}},
            {HEXA_POINTS, {60, 61, 63, 62, 4, 5, 6, 7}},
            {HEXA_POINTS, {59, 57, 1, 2, 63, 61, 5, 6}},
            {HEXA_POINTS, {2, 3, 58, 59, 6, 7, 62, 63}},
            //Hexa {0 1 2 3 56 57 59 58}
            {HEXA_POINTS, {0, 8, 64, 32, 56, 112, 144, 136}},
            {HEXA_POINTS, {8, 9, 65, 64, 112, 113, 145, 144}},
            {HEXA_POINTS, {9, 1, 33, 65, 113, 57, 137, 145}},
            {HEXA_POINTS, {64, 65, 33, 32, 144, 145, 137, 136}},
            {HEXA_POINTS, {144, 145, 137, 136, 112, 113, 57, 56}},
            {HEXA_POINTS, {10, 0, 32, 66, 114, 56, 136, 146}},
            {HEXA_POINTS, {11, 10, 66, 67, 115, 114, 146, 147}},
            {HEXA_POINTS, {3, 11, 67, 34, 58, 115, 147, 138}},
            {HEXA_POINTS, {67, 66, 32, 34, 147, 146, 136, 138}},
            {HEXA_POINTS, {147, 146, 136, 138, 115, 114, 56, 58}},
            {HEXA_POINTS, {32, 33, 35, 34, 136, 137, 139, 138}},
            {HEXA_POINTS, {136, 137, 139, 138, 56, 57, 59, 58}},
            {HEXA_POINTS, {35, 33, 1, 2, 139, 137, 57, 59}},
            {HEXA_POINTS, {2, 3, 34, 35, 59, 58, 138, 139}},
            //Hexa {57 56 0 1 61 60 4 5}
            {HEXA_POINTS, {0, 8, 112, 56, 40, 80, 176, 168}},
            {HEXA_POINTS, {8, 9, 113, 112, 80, 81, 177, 176}},
            {HEXA_POINTS, {112, 113, 57, 56, 176, 177, 170, 168}},
            {HEXA_POINTS, {80, 81, 177, 176, 40, 42, 170, 168}},
            {HEXA_POINTS, {9, 1, 57, 113, 81, 42, 170, 177}},
            {HEXA_POINTS, {0, 40, 168, 56, 24, 84, 180, 128}},
            {HEXA_POINTS, {24, 84, 180, 128, 25, 85, 181, 129}},
            {HEXA_POINTS, {84, 40, 168, 180, 85, 41, 169, 181}},
            {HEXA_POINTS, {128, 180, 168, 56, 129, 181, 169, 60}},
            {HEXA_POINTS, {25, 85, 181, 129, 4, 41, 169, 60}},
            {HEXA_POINTS, {40, 42, 170, 168, 41, 43, 171, 169}},
            {HEXA_POINTS, {168, 170, 57, 56, 169, 171, 61, 60}},
            {HEXA_POINTS, {41, 43, 171, 169, 4, 5, 61, 60}},
            {HEXA_POINTS, {42, 1, 57, 170, 43, 5, 61, 171}},
            //Hexa {3 0 56 58 7 4 60 62}
            {HEXA_POINTS, {0, 56, 114, 10, 44, 184, 192, 88}},
            {HEXA_POINTS, {10, 114, 115, 11, 88, 192, 193, 89}},
            {HEXA_POINTS, {114, 56, 58, 115, 192, 184, 186, 193}},
            {HEXA_POINTS, {11, 115, 58, 3, 89, 193, 186, 46}},
            {HEXA_POINTS, {88, 192, 193, 89, 44, 184, 186, 46}},
            {HEXA_POINTS, {44, 0, 56, 184, 92, 24, 128, 196}},
            {HEXA_POINTS, {44, 92, 196, 184, 45, 93, 197, 185}},
            {HEXA_POINTS, {92, 24, 128, 196, 93, 25, 129, 197}},
            {HEXA_POINTS, {93, 25, 129, 197, 45, 4, 60, 185}},
            {HEXA_POINTS, {196, 128, 56, 184, 197, 129, 60, 185}},
            {HEXA_POINTS, {46, 44, 184, 186, 47, 45, 185, 187}},
            {HEXA_POINTS, {186, 184, 56, 58, 187, 185, 60, 62}},
            {HEXA_POINTS, {3, 46, 186, 58, 7, 47, 187, 62}},
            {HEXA_POINTS, {47, 45, 185, 187, 7, 4, 60, 62}}
         }
      },
      { // T4C
         6, {
            //Centro & otros
            {HEXA_POINTS, {56, 57, 59, 58, 60, 61, 63, 62}},
            {HEXA_POINTS, {60, 61, 63, 62, 4, 5, 6, 7}},
            {HEXA_POINTS, {59, 57, 1, 2, 63, 61, 5, 6}},
            //Hexa {0 1 2 3 56 57 59 58}
            {HEXA_POINTS, {0, 8, 64, 32, 56, 112, 144, 136}},
            {HEXA_POINTS, {8, 9, 65, 64, 112, 113, 145, 144}},
            {HEXA_POINTS, {9, 1, 33, 65, 113, 57, 137, 145}},
            {HEXA_POINTS, {64, 65, 33, 32, 144, 145, 137, 136}},
            {HEXA_POINTS, {144, 145, 137, 136, 112, 113, 57, 56}},
            {HEXA_POINTS, {10, 0, 32, 66, 114, 56, 136, 146}},
            {HEXA_POINTS, {11, 10, 66, 67, 115, 114, 146, 147}},
            {HEXA_POINTS, {3, 11, 67, 34, 58, 115, 147, 138}},
            {HEXA_POINTS, {67, 66, 32, 34, 147, 146, 136, 138}},
            {HEXA_POINTS, {147, 146, 136, 138, 115, 114, 56, 58}},
            {HEXA_POINTS, {32, 33, 35, 34, 136, 137, 139, 138}},
            {HEXA_POINTS, {136, 137, 139, 138, 56, 57, 59, 58}},
            {HEXA_POINTS, {35, 33, 1, 2, 139, 137, 57, 59}},
            {HEXA_POINTS, {2, 3, 34, 35, 59, 58, 138, 139}},
            //Hexa {57 56 0 1 61 60 4 5}
            {HEXA_POINTS, {0, 8, 112, 56, 4, 41, 173, 60}},
            {HEXA_POINTS, {8, 9, 113, 112, 41, 43, 175, 173}},
            {HEXA_POINTS, {9, 1, 57, 113, 43, 5, 61, 175}},
            {HEXA_POINTS, {112, 113, 57, 56, 173, 175, 61, 60}},
            {HEXA_POINTS, {41, 43, 175, 173, 4, 5, 61, 60}},
            //Hexa {3 0 56 58 7 4 60 62}
            {HEXA_POINTS, {10, 0, 56, 114, 88, 44, 184, 192}},
            {HEXA_POINTS, {11, 10, 114, 115, 89, 88, 192, 193}},
            {HEXA_POINTS, {3, 11, 115, 58, 46, 89, 193, 186}},
            {HEXA_POINTS, {89, 88, 192, 193, 46, 44, 184, 186}},
            {HEXA_POINTS, {115, 114, 56, 58, 193, 192, 184, 186}},
            {HEXA_POINTS, {46, 186, 58, 3, 94, 198, 132, 28}},
            {HEXA_POINTS, {94, 198, 132, 28, 95, 199, 133, 29}},
            {HEXA_POINTS, {95, 199, 133, 29, 47, 187, 62, 7}},
            {HEXA_POINTS, {46, 186, 198, 94, 47, 187, 199, 95}},
            {HEXA_POINTS, {198, 186, 58, 132, 199, 187, 62, 133}},
            {HEXA_POINTS, {46, 44, 184, 186, 47, 45, 185, 187}},
            {HEXA_POINTS, {186, 184, 56, 58, 187, 185, 60, 62}},
            {HEXA_POINTS, {184, 44, 0, 56, 185, 45, 4, 60}},
            {HEXA_POINTS, {47, 45, 185, 187, 7, 4, 60, 62}},
            //Hexa {2 3 58 59 6 7 62 63}
            {HEXA_POINTS, {2, 3, 58, 59, 54, 28, 132, 222}},
            {HEXA_POINTS, {54, 28, 132, 222, 55, 29, 133, 223}},
            {HEXA_POINTS, {55, 29, 133, 223, 6, 7, 62, 63}},
            {HEXA_POINTS, {222, 132, 58, 59, 223, 133, 62, 63}},
            {HEXA_POINTS, {2, 54, 222, 59, 6, 55, 223, 63}}
         }
      },
      { // T4C.b
         7, {
            //Centro & otros
            {HEXA_POINTS, {56, 57, 59, 58, 60, 61, 63, 62}},
            {HEXA_POINTS, {60, 61, 63, 62, 4, 5, 6, 7}},
            {HEXA_POINTS, {59, 57, 1, 2, 63, 61, 5, 6}},
            //Hexa {0 1 2 3 56 57 59 58}
            {HEXA_POINTS, {10, 0, 32, 66, 114, 56, 136, 146}},
            {HEXA_POINTS, {11, 10, 66, 67, 115, 114, 146, 147}},
            {HEXA_POINTS, {3, 11, 67, 34, 58, 115, 147, 138}},
            {HEXA_POINTS, {67, 66, 32, 34, 147, 146, 136, 138}},
            {HEXA_POINTS, {147, 146, 136, 138, 115, 114, 56, 58}},
            {HEXA_POINTS, {34, 70, 14, 3, 138, 150, 118, 58}},
            {HEXA_POINTS, {70, 71, 15, 14, 150, 151, 119, 118}},
            {HEXA_POINTS, {71, 35, 2, 15, 151, 139, 59, 119}},
            {HEXA_POINTS, {34, 35, 71, 70, 138, 139, 151, 150}},
            {HEXA_POINTS, {138, 139, 151, 150, 58, 59, 119, 118}},
            {HEXA_POINTS, {0, 1, 33, 32, 56, 57, 137, 136}},
            {HEXA_POINTS, {35, 33, 1, 2, 139, 137, 57, 59}},
            {HEXA_POINTS, {32, 33, 35, 34, 136, 137, 139, 138}},
            {HEXA_POINTS, {136, 137, 139, 138, 56, 57, 59, 58}},
            //Hexa {57 56 0 1 61 60 4 5}
            {HEXA_POINTS, {57, 56, 0, 1, 174, 128, 24, 42}},
            {HEXA_POINTS, {174, 128, 24, 42, 175, 129, 25, 43}},
            {HEXA_POINTS, {175, 129, 25, 43, 61, 60, 4, 5}},
            {HEXA_POINTS, {57, 56, 128, 174, 61, 60, 129, 175}},
            {HEXA_POINTS, {57, 174, 42, 1, 61, 175, 43, 5}},
            //Hexa {2 3 58 59 6 7 62 63}
            {HEXA_POINTS, {3, 58, 118, 14, 7, 62, 221, 53}},
            {HEXA_POINTS, {14, 118, 119, 15, 53, 221, 223, 55}},
            {HEXA_POINTS, {58, 59, 119, 118, 62, 63, 223, 221}},
            {HEXA_POINTS, {15, 119, 59, 2, 55, 223, 63, 6}},
            {HEXA_POINTS, {221, 223, 55, 53, 62, 63, 6, 7}},
            //Hexa {3 0 56 58 7 4 60 62}
            {HEXA_POINTS, {0, 56, 114, 10, 44, 184, 192, 88}},
            {HEXA_POINTS, {10, 114, 115, 11, 88, 192, 193, 89}},
            {HEXA_POINTS, {114, 56, 58, 115, 192, 184, 186, 193}},
            {HEXA_POINTS, {11, 115, 58, 3, 89, 193, 186, 46}},
            {HEXA_POINTS, {88, 192, 193, 89, 44, 184, 186, 46}},
            {HEXA_POINTS, {44, 0, 56, 184, 92, 24, 128, 196}},
            {HEXA_POINTS, {44, 92, 196, 184, 45, 93, 197, 185}},
            {HEXA_POINTS, {92, 24, 128, 196, 93, 25, 129, 197}},
            {HEXA_POINTS, {93, 25, 129, 197, 45, 4, 60, 185}},
            {HEXA_POINTS, {196, 128, 56, 184, 197, 129, 60, 185}},
            {HEXA_POINTS, {46, 44, 184, 186, 47, 45, 185, 187}},
            {HEXA_POINTS, {186, 184, 56, 58, 187, 185, 60, 62}},
            {HEXA_POINTS, {3, 46, 186, 58, 7, 47, 187, 62}},
            {HEXA_POINTS, {47, 45, 185, 187, 7, 4, 60, 62}}
        }
      },
      { // T5A
         8, {
            //Centro
            {HEXA_POINTS, {56, 57, 59, 58, 60, 61, 63, 62}},
            //Hexa {0 1 2 3 56 57 59 58}
            {HEXA_POINTS, {0, 8, 32, 10, 56, 112, 136, 114}},
            {HEXA_POINTS, {8, 9, 33, 32, 112, 113, 137, 136}},
            {HEXA_POINTS, {9, 1, 12, 33, 113, 57, 116, 137}},
            {HEXA_POINTS, {10, 32, 34, 11, 114, 136, 138, 115}},
            {HEXA_POINTS, {32, 33, 35, 34, 136, 137, 139, 138}},
            {HEXA_POINTS, {33, 12, 13, 35, 137, 116, 117, 139}},
            {HEXA_POINTS, {11, 34, 14, 3, 115, 138, 118, 58}},
            {HEXA_POINTS, {34, 35, 15, 14, 138, 139, 119, 118}},
            {HEXA_POINTS, {35, 13, 2, 15, 139, 117, 59, 119}},
            {HEXA_POINTS, {136, 137, 139, 138, 112, 113, 119, 118}},
            {HEXA_POINTS, {114, 136, 138, 115, 56, 112, 118, 58}},
            {HEXA_POINTS, {112, 113, 119, 118, 56, 57, 59, 58}},
            {HEXA_POINTS, {137, 116, 117, 139, 113, 57, 59, 119}},
            //Hexa {60 61 63 62 4 5 6 7}
            {HEXA_POINTS, {60, 61, 63, 62, 4, 5, 6, 7}},
            //Hexa {57 56 0 1 61 60 4 5}
            {HEXA_POINTS, {0, 8, 112, 56, 40, 80, 176, 168}},
            {HEXA_POINTS, {8, 9, 113, 112, 80, 81, 177, 176}},
            {HEXA_POINTS, {112, 113, 57, 56, 176, 177, 170, 168}},
            {HEXA_POINTS, {80, 81, 177, 176, 40, 42, 170, 168}},
            {HEXA_POINTS, {9, 1, 57, 113, 81, 42, 170, 177}},
            {HEXA_POINTS, {0, 40, 168, 56, 24, 84, 180, 128}},
            {HEXA_POINTS, {24, 84, 180, 128, 25, 85, 181, 129}},
            {HEXA_POINTS, {84, 40, 168, 180, 85, 41, 169, 181}},
            {HEXA_POINTS, {128, 180, 168, 56, 129, 181, 169, 60}},
            {HEXA_POINTS, {25, 85, 181, 129, 4, 41, 169, 60}},
            {HEXA_POINTS, {40, 42, 170, 168, 41, 43, 171, 169}},
            {HEXA_POINTS, {168, 170, 57, 56, 169, 171, 61, 60}},
            {HEXA_POINTS, {41, 43, 171, 169, 4, 5, 61, 60}},
            {HEXA_POINTS, {42, 1, 57, 170, 43, 5, 61, 171}},
            //Hexa {59 57 1 2 63 61 5 6}
            {HEXA_POINTS, {57, 1, 12, 116, 61, 5, 49, 205}},
            {HEXA_POINTS, {57, 116, 117, 59, 61, 205, 207, 63}},
            {HEXA_POINTS, {116, 12, 13, 117, 205, 49, 51, 207}},
            {HEXA_POINTS, {59, 117, 13, 2, 63, 207, 51, 6}},
            {HEXA_POINTS, {205, 49, 51, 207, 61, 5, 6, 63}},
            //Hexa {2 3 58 59 6 7 62 63}
            {HEXA_POINTS, {3, 58, 118, 14, 7, 62, 221, 53}},
            {HEXA_POINTS, {14, 118, 119, 15, 53, 221, 223, 55}},
            {HEXA_POINTS, {58, 59, 119, 118, 62, 63, 223, 221}},
            {HEXA_POINTS, {15, 119, 59, 2, 55, 223, 63, 6}},
            {HEXA_POINTS, {221, 223, 55, 53, 62, 63, 6, 7}},
            //Hexa {3 0 56 58 7 4 60 62}
            {HEXA_POINTS, {0, 56, 114, 10, 44, 184, 192, 88}},
            {HEXA_POINTS, {10, 114, 115, 11, 88, 192, 193, 89}},
            {HEXA_POINTS, {114, 56, 58, 115, 192, 184, 186, 193}},
            {HEXA_POINTS, {11, 115, 58, 3, 89, 193, 186, 46}},
            {HEXA_POINTS, {88, 192, 193, 89, 44, 184, 186, 46}},
            {HEXA_POINTS, {44, 0, 56, 184, 92, 24, 128, 196}},
            {HEXA_POINTS, {44, 92, 196, 184, 45, 93, 197, 185}},
            {HEXA_POINTS, {92, 24, 128, 196, 93, 25, 129, 197}},
            {HEXA_POINTS, {93, 25, 129, 197, 45, 4, 60, 185}},
            {HEXA_POINTS, {196, 128, 56, 184, 197, 129, 60, 185}},
            {HEXA_POINTS, {46, 44, 184, 186, 47, 45, 185, 187}},
            {HEXA_POINTS, {186, 184, 56, 58, 187, 185, 60, 62}},
            {HEXA_POINTS, {3, 46, 186, 58, 7, 47, 187, 62}},
            {HEXA_POINTS, {47, 45, 185, 187, 7, 4, 60, 62}}
         }
      },
      { // T6
         9, {
            // Center
            {HEXA_POINTS, {32, 33, 35, 34, 36, 37, 39, 38}},
            //Hexa {33 32 0 1 37 36 4 5}
            {HEXA_POINTS, {33, 32, 0, 1, 174, 128, 24, 42}},
            {HEXA_POINTS, {174, 128, 24, 42, 175, 129, 25, 43}},
            {HEXA_POINTS, {175, 129, 25, 43, 37, 36, 4, 5}},
            {HEXA_POINTS, {33, 32, 128, 174, 37, 36, 129, 175}},
            {HEXA_POINTS, {1, 33, 174, 42, 5, 37, 175, 43}},
            //Hexa {3 0 32 34 7 4 36 38}
            {HEXA_POINTS, {10, 0, 32, 66, 44, 24, 128, 184}},
            {HEXA_POINTS, {11, 10, 66, 67, 46, 44, 184, 186}},
            {HEXA_POINTS, {3, 11, 67, 34, 28, 46, 186, 132}},
            {HEXA_POINTS, {44, 24, 128, 184, 45, 25, 129, 185}},
            {HEXA_POINTS, {46, 44, 184, 186, 47, 45, 185, 187}},
            {HEXA_POINTS, {28, 46, 186, 132, 29, 47, 187, 133}},
            {HEXA_POINTS, {45, 25, 129, 185, 18, 4, 36, 74}},
            {HEXA_POINTS, {47, 45, 185, 187, 19, 18, 74, 75}},
            {HEXA_POINTS, {29, 47, 187, 133, 7, 19, 75, 38}},
            {HEXA_POINTS, {67, 66, 32, 34, 186, 184, 128, 132}},
            {HEXA_POINTS, {186, 184, 128, 132, 187, 185, 129, 133}},
            {HEXA_POINTS, {187, 185, 129, 133, 75, 74, 36, 38}},
            {HEXA_POINTS, {132, 128, 32, 34, 133, 129, 36, 38}},
            //Hexa {35 33 1 2 39 37 5 6}
            {HEXA_POINTS, {35, 33, 1, 2, 134, 204, 48, 30}},
            {HEXA_POINTS, {134, 204, 48, 30, 135, 205, 49, 31}},
            {HEXA_POINTS, {135, 205, 49, 31, 39, 37, 5, 6}},
            {HEXA_POINTS, {35, 33, 204, 134, 39, 37, 205, 135}},
            {HEXA_POINTS, {33, 1, 48, 204, 37, 5, 49, 205}},
            //Hexa {2 3 34 35 6 7 38 39}
            {HEXA_POINTS, {14, 3, 34, 70, 52, 28, 132, 216}},
            {HEXA_POINTS, {15, 14, 70, 71, 54, 52, 216, 218}},
            {HEXA_POINTS, {2, 15, 71, 35, 30, 54, 218, 134}},
            {HEXA_POINTS, {52, 28, 132, 216, 53, 29, 133, 217}},
            {HEXA_POINTS, {54, 52, 216, 218, 55, 53, 217, 219}},
            {HEXA_POINTS, {30, 54, 218, 134, 31, 55, 219, 135}},
            {HEXA_POINTS, {53, 29, 133, 217, 22, 7, 38, 78}},
            {HEXA_POINTS, {55, 53, 217, 219, 23, 22, 78, 79}},
            {HEXA_POINTS, {31, 55, 219, 135, 6, 23, 79, 39}},
            {HEXA_POINTS, {71, 70, 34, 35, 218, 216, 132, 134}},
            {HEXA_POINTS, {218, 216, 132, 134, 219, 217, 133, 135}},
            {HEXA_POINTS, {219, 217, 133, 135, 79, 78, 38, 39}},
            {HEXA_POINTS, {134, 132, 34, 35, 135, 133, 38, 39}}
         }
      },
      { // T6B
         10, {
            //Centro & otros
            {HEXA_POINTS, {56, 57, 59, 58, 60, 61, 63, 62}},
            {HEXA_POINTS, {60, 61, 63, 62, 4, 5, 6, 7}},
            //Hexa {0 1 2 3 56 57 59 58}
            {HEXA_POINTS, {0, 8, 32, 10, 56, 112, 136, 114}},
            {HEXA_POINTS, {8, 9, 33, 32, 112, 113, 137, 136}},
            {HEXA_POINTS, {9, 1, 12, 33, 113, 57, 116, 137}},
            {HEXA_POINTS, {10, 32, 34, 11, 114, 136, 138, 115}},
            {HEXA_POINTS, {32, 33, 35, 34, 136, 137, 139, 138}},
            {HEXA_POINTS, {33, 12, 13, 35, 137, 116, 117, 139}},
            {HEXA_POINTS, {11, 34, 14, 3, 115, 138, 118, 58}},
            {HEXA_POINTS, {34, 35, 15, 14, 138, 139, 119, 118}},
            {HEXA_POINTS, {35, 13, 2, 15, 139, 117, 59, 119}},
            {HEXA_POINTS, {136, 137, 139, 138, 112, 113, 119, 118}},
            {HEXA_POINTS, {114, 136, 138, 115, 56, 112, 118, 58}},
            {HEXA_POINTS, {112, 113, 119, 118, 56, 57, 59, 58}},
            {HEXA_POINTS, {137, 116, 117, 139, 113, 57, 59, 119}},
            //Hexa {57 56 0 1 61 60 4 5}
            {HEXA_POINTS, {0, 8, 112, 56, 40, 80, 176, 168}},
            {HEXA_POINTS, {8, 9, 113, 112, 80, 81, 177, 176}},
            {HEXA_POINTS, {112, 113, 57, 56, 176, 177, 170, 168}},
            {HEXA_POINTS, {80, 81, 177, 176, 40, 42, 170, 168}},
            {HEXA_POINTS, {9, 1, 57, 113, 81, 42, 170, 177}},
            {HEXA_POINTS, {0, 40, 168, 56, 24, 84, 180, 128}},
            {HEXA_POINTS, {24, 84, 180, 128, 25, 85, 181, 129}},
            {HEXA_POINTS, {84, 40, 168, 180, 85, 41, 169, 181}},
            {HEXA_POINTS, {128, 180, 168, 56, 129, 181, 169, 60}},
            {HEXA_POINTS, {25, 85, 181, 129, 4, 41, 169, 60}},
            {HEXA_POINTS, {40, 42, 170, 168, 41, 43, 171, 169}},
            {HEXA_POINTS, {168, 170, 57, 56, 169, 171, 61, 60}},
            {HEXA_POINTS, {41, 43, 171, 169, 4, 5, 61, 60}},
            {HEXA_POINTS, {42, 1, 57, 170, 43, 5, 61, 171}},
            //Hexa {3 0 56 58 7 4 60 62}
            {HEXA_POINTS, {0, 56, 114, 10, 44, 184, 192, 88}},
            {HEXA_POINTS, {10, 114, 115, 11, 88, 192, 193, 89}},
            {HEXA_POINTS, {114, 56, 58, 115, 192, 184, 186, 193}},
            {HEXA_POINTS, {11, 115, 58, 3, 89, 193, 186, 46}},
            {HEXA_POINTS, {88, 192, 193, 89, 44, 184, 186, 46}},
            {HEXA_POINTS, {44, 0, 56, 184, 92, 24, 128, 196}},
            {HEXA_POINTS, {44, 92, 196, 184, 45, 93, 197, 185}},
            {HEXA_POINTS, {92, 24, 128, 196, 93, 25, 129, 197}},
            {HEXA_POINTS, {93, 25, 129, 197, 45, 4, 60, 185}},
            {HEXA_POINTS, {196, 128, 56, 184, 197, 129, 60, 185}},
            {HEXA_POINTS, {46, 44, 184, 186, 47, 45, 185, 187}},
            {HEXA_POINTS, {186, 184, 56, 58, 187, 185, 60, 62}},
            {HEXA_POINTS, {3, 46, 186, 58, 7, 47, 187, 62}},
            {HEXA_POINTS, {47, 45, 185, 187, 7, 4, 60, 62}},
            //Hexa {59 57 1 2 63 61 5 6}
            {HEXA_POINTS, {116, 57, 1, 12, 208, 200, 48, 96}},
            {HEXA_POINTS, {117, 116, 12, 13, 209, 208, 96, 97}},
            {HEXA_POINTS, {59, 117, 13, 2, 202, 209, 97, 50}},
            {HEXA_POINTS, {209, 208, 96, 97, 202, 200, 48, 50}},
            {HEXA_POINTS, {117, 116, 208, 209, 59, 57, 200, 202}},
            {HEXA_POINTS, {59, 202, 50, 2, 134, 214, 102, 30}},
            {HEXA_POINTS, {134, 214, 102, 30, 135, 215, 103, 31}},
            {HEXA_POINTS, {135, 215, 103, 31, 63, 203, 51, 6}},
            {HEXA_POINTS, {134, 59, 202, 214, 135, 63, 203, 215}},
            {HEXA_POINTS, {214, 202, 50, 102, 215, 203, 51, 103}},
            {HEXA_POINTS, {200, 57, 1, 48, 201, 61, 5, 49}},
            {HEXA_POINTS, {63, 61, 201, 203, 6, 5, 49, 51}},
            {HEXA_POINTS, {59, 57, 200, 202, 63, 61, 201, 203}},
            {HEXA_POINTS, {202, 200, 48, 50, 203, 201, 49, 51}},
            //Hexa {2 3 58 59 6 7 62 63}
            {HEXA_POINTS, {14, 3, 58, 118, 104, 52, 216, 224}},
            {HEXA_POINTS, {15, 14, 118, 119, 105, 104, 224, 225}},
            {HEXA_POINTS, {2, 15, 119, 59, 54, 105, 225, 218}},
            {HEXA_POINTS, {105, 104, 224, 225, 54, 52, 216, 218}},
            {HEXA_POINTS, {225, 224, 118, 119, 218, 216, 58, 59}},
            {HEXA_POINTS, {2, 54, 218, 59, 30, 110, 230, 134}},
            {HEXA_POINTS, {30, 110, 230, 134, 31, 111, 231, 135}},
            {HEXA_POINTS, {31, 111, 231, 135, 6, 55, 219, 63}},
            {HEXA_POINTS, {110, 54, 218, 230, 111, 55, 219, 231}},
            {HEXA_POINTS, {230, 218, 59, 134, 231, 219, 63, 135}},
            {HEXA_POINTS, {52, 3, 58, 216, 53, 7, 62, 217}},
            {HEXA_POINTS, {55, 53, 217, 219, 6, 7, 62, 63}},
            {HEXA_POINTS, {54, 52, 216, 218, 55, 53, 217, 219}},
            {HEXA_POINTS, {218, 216, 58, 59, 219, 217, 62, 63}}
         }
      },
      { // T7
         11, {
            //Center
            {HEXA_POINTS, {56, 57, 59, 58, 60, 61, 63, 62}},
            //Hexa {0 1 2 3 56 57 59 58}
            {HEXA_POINTS, {0, 8, 32, 10, 56, 112, 136, 114}},
            {HEXA_POINTS, {8, 9, 33, 32, 112, 113, 137, 136}},
            {HEXA_POINTS, {9, 1, 12, 33, 113, 57, 116, 137}},
            {HEXA_POINTS, {10, 32, 34, 11, 114, 136, 138, 115}},
            {HEXA_POINTS, {32, 33, 35, 34, 136, 137, 139, 138}},
            {HEXA_POINTS, {33, 12, 13, 35, 137, 116, 117, 139}},
            {HEXA_POINTS, {11, 34, 14, 3, 115, 138, 118, 58}},
            {HEXA_POINTS, {34, 35, 15, 14, 138, 139, 119, 118}},
            {HEXA_POINTS, {35, 13, 2, 15, 139, 117, 59, 119}},
            {HEXA_POINTS, {136, 137, 139, 138, 112, 113, 119, 118}},
            {HEXA_POINTS, {114, 136, 138, 115, 56, 112, 118, 58}},
            {HEXA_POINTS, {112, 113, 119, 118, 56, 57, 59, 58}},
            {HEXA_POINTS, {137, 116, 117, 139, 113, 57, 59, 119}},
            //Hexa {60 61 63 62 4 5 6 7}
            {HEXA_POINTS, {4, 16, 120, 60, 36, 72, 160, 152}},
            {HEXA_POINTS, {16, 17, 121, 120, 72, 73, 161, 160}},
            {HEXA_POINTS, {17, 5, 61, 121, 73, 37, 153, 161}},
            {HEXA_POINTS, {120, 121, 61, 60, 160, 161, 153, 152}},
            {HEXA_POINTS, {160, 161, 153, 152, 72, 73, 37, 36}},
            {HEXA_POINTS, {18, 4, 60, 122, 74, 36, 152, 162}},
            {HEXA_POINTS, {19, 18, 122, 123, 75, 74, 162, 163}},
            {HEXA_POINTS, {7, 19, 123, 62, 38, 75, 163, 154}},
            {HEXA_POINTS, {123, 122, 60, 62, 163, 162, 152, 154}},
            {HEXA_POINTS, {163, 162, 152, 154, 75, 74, 36, 38}},
            {HEXA_POINTS, {60, 61, 63, 62, 152, 153, 155, 154}},
            {HEXA_POINTS, {152, 153, 155, 154, 36, 37, 39, 38}},
            {HEXA_POINTS, {63, 61, 5, 6, 155, 153, 37, 39}},
            {HEXA_POINTS, {6, 7, 62, 63, 39, 38, 154, 155}},
            //Hexa {57 56 0 1 61 60 4 5}
            {HEXA_POINTS, {0, 8, 112, 56, 24, 40, 168, 128}},
            {HEXA_POINTS, {8, 9, 113, 112, 40, 42, 170, 168}},
            {HEXA_POINTS, {9, 1, 57, 113, 42, 26, 130, 170}},
            {HEXA_POINTS, {24, 40, 168, 128, 25, 41, 169, 129}},
            {HEXA_POINTS, {40, 42, 170, 168, 41, 43, 171, 169}},
            {HEXA_POINTS, {42, 26, 130, 170, 43, 27, 131, 171}},
            {HEXA_POINTS, {25, 41, 169, 129, 4, 16, 120, 60}},
            {HEXA_POINTS, {41, 43, 171, 169, 16, 17, 121, 120}},
            {HEXA_POINTS, {43, 27, 131, 171, 17, 5, 61, 121}},
            {HEXA_POINTS, {128, 168, 112, 56, 129, 169, 120, 60}},
            {HEXA_POINTS, {168, 170, 113, 112, 169, 171, 121, 120}},
            {HEXA_POINTS, {170, 130, 57, 113, 171, 131, 61, 121}},
            {HEXA_POINTS, {112, 113, 57, 56, 120, 121, 61, 60}},
            //Hexa {3 0 56 58 7 4 60 62}
            {HEXA_POINTS, {10, 0, 56, 114, 44, 24, 128, 184}},
            {HEXA_POINTS, {11, 10, 114, 115, 46, 44, 184, 186}},
            {HEXA_POINTS, {3, 11, 115, 58, 28, 46, 186, 132}},
            {HEXA_POINTS, {44, 24, 128, 184, 45, 25, 129, 185}},
            {HEXA_POINTS, {46, 44, 184, 186, 47, 45, 185, 187}},
            {HEXA_POINTS, {28, 46, 186, 132, 29, 47, 187, 133}},
            {HEXA_POINTS, {45, 25, 129, 185, 18, 4, 60, 122}},
            {HEXA_POINTS, {47, 45, 185, 187, 19, 18, 122, 123}},
            {HEXA_POINTS, {29, 47, 187, 133, 7, 19, 123, 62}},
            {HEXA_POINTS, {184, 128, 56, 114, 185, 129, 60, 122}},
            {HEXA_POINTS, {186, 184, 114, 115, 187, 185, 122, 123}},
            {HEXA_POINTS, {132, 186, 115, 58, 133, 187, 123, 62}},
            {HEXA_POINTS, {115, 114, 56, 58, 123, 122, 60, 62}},
            //Hexa {59 57 1 2 63 61 5 6}
            {HEXA_POINTS, {116, 57, 1, 12, 208, 200, 48, 96}},
            {HEXA_POINTS, {117, 116, 12, 13, 209, 208, 96, 97}},
            {HEXA_POINTS, {59, 117, 13, 2, 202, 209, 97, 50}},
            {HEXA_POINTS, {209, 208, 96, 97, 202, 200, 48, 50}},
            {HEXA_POINTS, {117, 116, 208, 209, 59, 57, 200, 202}},
            {HEXA_POINTS, {200, 57, 1, 48, 212, 130, 26, 100}},
            {HEXA_POINTS, {212, 130, 26, 100, 213, 131, 27, 101}},
            {HEXA_POINTS, {213, 131, 27, 101, 201, 61, 5, 49}},
            {HEXA_POINTS, {200, 212, 100, 48, 201, 213, 101, 49}},
            {HEXA_POINTS, {57, 130, 212, 200, 61, 131, 213, 201}},
            {HEXA_POINTS, {202, 200, 48, 50, 203, 201, 49, 51}},
            {HEXA_POINTS, {59, 57, 200, 202, 63, 61, 201, 203}},
            {HEXA_POINTS, {59, 202, 50, 2, 63, 203, 51, 6}},
            {HEXA_POINTS, {203, 201, 49, 51, 63, 61, 5, 6}},
            //Hexa {2 3 58 59 6 7 62 63}
            {HEXA_POINTS, {14, 3, 58, 118, 104, 52, 216, 224}},
            {HEXA_POINTS, {15, 14, 118, 119, 105, 104, 224, 225}},
            {HEXA_POINTS, {2, 15, 119, 59, 54, 105, 225, 218}},
            {HEXA_POINTS, {105, 104, 224, 225, 54, 52, 216, 218}},
            {HEXA_POINTS, {225, 224, 118, 119, 218, 216, 58, 59}},
            {HEXA_POINTS, {216, 52, 3, 58, 228, 108, 28, 132}},
            {HEXA_POINTS, {228, 108, 28, 132, 229, 109, 29, 133}},
            {HEXA_POINTS, {229, 109, 29, 133, 217, 53, 7, 62}},
            {HEXA_POINTS, {216, 52, 108, 228, 217, 53, 109, 229}},
            {HEXA_POINTS, {58, 216, 228, 132, 62, 217, 229, 133}},
            {HEXA_POINTS, {54, 52, 216, 218, 55, 53, 217, 219}},
            {HEXA_POINTS, {218, 216, 58, 59, 219, 217, 62, 63}},
            {HEXA_POINTS, {54, 218, 59, 2, 55, 219, 63, 6}},
            {HEXA_POINTS, {55, 53, 217, 219, 6, 7, 62, 63}}
         }
      },
      { // T8
         12, {
            {HEXA_POINTS, {0,8,32,10,24,40,56,44}},
            {HEXA_POINTS, {8,9,33,32,40,42,57,56}},
            {HEXA_POINTS, {9,1,12,33,42,26,48,57}},
            {HEXA_POINTS, {10,32,34,11,44,56,58,46}},
            {HEXA_POINTS, {32,33,35,34,56,57,59,58}},
            {HEXA_POINTS, {33,12,13,35,57,48,50,59}},
            {HEXA_POINTS, {11,34,14,3,46,58,52,28}},
            {HEXA_POINTS, {34,35,15,14,58,59,54,52}},
            {HEXA_POINTS, {35,13,2,15,59,50,30,54}},
            {HEXA_POINTS, {24,40,56,44,25,41,60,45}},
            {HEXA_POINTS, {40,42,57,56,41,43,61,60}},
            {HEXA_POINTS, {42,26,48,57,43,27,49,61}},
            {HEXA_POINTS, {44,56,58,46,45,60,62,47}},
            {HEXA_POINTS, {56,57,59,58, 60,61,63,62}},
            {HEXA_POINTS, {57,48,50,59,61,49,51,63}},
            {HEXA_POINTS, {46,58,52,28,47,62,53,29}},
            {HEXA_POINTS, {58,59,54,52,62,63,55,53}},
            {HEXA_POINTS, {59,50,30,54,63,51,31,55}},
            {HEXA_POINTS, {25,41,60,45,4,16,36,18}},
            {HEXA_POINTS, {41,43,61,60,16,17,37,36}},
            {HEXA_POINTS, {43,27,49,61,17,5,20,37}},
            {HEXA_POINTS, {45,60,62,47,18,36,38,19}},
            {HEXA_POINTS, {60,61,63,62,36,37,39,38}},
            {HEXA_POINTS, {61,49,51,63,37,20,21,39}},
            {HEXA_POINTS, {47,62,53,29,19,38,22,7}},
            {HEXA_POINTS, {62,63,55,53,38,39,23,22}},
            {HEXA_POINTS, {63,51,31,55,39,21,6,23}}
         }
      }
   };

   const map<Uint, vector<vector<Uint>>> PatternFactory::template_edges_map = {
      // T2   [ 0 3 ]
      {1, {
         {0, 3, 10, 11}}},
      // T3   [ 0 1 3]   
      {2, {
         {0, 1, 8, 9},
         {0, 3, 10, 11}}},
      // T4   [ 0 1 3 2 ]
      {3, {
         {0, 1, 8, 9},
         {0, 3, 10, 11},
         {1, 2, 12, 13},
         {3, 2, 14, 15}}},
      // T40  [ 0 1 7 6 ]
      {4, {
         {0, 1, 8, 9},
         {7, 6, 22, 23}}},
      // T4B  [0 1 3 4]
      {5, {
         {0, 1, 8, 9},
         {0, 3, 10, 11},
         {0, 4, 24, 25}}},
      // T4C  [0 1 3 7]
      {6, {
         {0, 1, 8, 9},
         {0, 3, 10, 11},
         {3, 7, 28, 29}}},
      // T4Cb [0 2 3 4]
      {7, {
         {0, 3, 10, 11},
         {0, 4, 24, 25},
         {3, 2, 14, 15}}},
      // T5A  [ 0 1 2 3 4 ]
      {8, {
         {0, 1, 8, 9},
         {0, 3, 10, 11},
         {1, 2, 12, 13},
         {3, 2, 14, 15},
         {0, 4, 24, 25}}},
      // T6   [ 0 3 2 4 7 6 ]
      {9, {
         {0, 3, 10, 11},
         {3, 2, 14, 15},
         {4, 7, 18, 19},
         {7, 6, 22, 23},
         {0, 4, 24, 25},
         {3, 7, 28, 29},
         {2, 6, 30, 31}}},
      // T6B  [0 1 2 3 4 6]
      {10, {
         {0, 1, 8, 9},
         {0, 3, 10, 11},
         {1, 2, 12, 13},
         {3, 2, 14, 15},
         {0, 4, 24, 25},
         {2, 6, 30, 31}}},
      // T7   [ 0 1 2 3 4 5 7 ]
      {11, {
         {0, 1, 8, 9},
         {0, 3, 10, 11},
         {1, 2, 12, 13},
         {3, 2, 14, 15},
         {4, 5, 16, 17},
         {4, 7, 18, 19},
         {0, 4, 24, 25},
         {1, 5, 26, 27},
         {3, 7, 28, 29}}},
      // T8   [ 0 1 2 3 4 5 6 7 ]
      {12, {
         {0, 1, 8, 9},
         {0, 3, 10, 11},
         {1, 2, 12, 13},
         {3, 2, 14, 15},
         {4, 5, 16, 17},
         {4, 7, 18, 19},
         {5, 6, 20, 21},
         {7, 6, 22, 23},
         {0, 4, 24, 25},
         {1, 5, 26, 27},
         {3, 7, 28, 29},
         {2, 6, 30, 31}}},
   };

   bool PatternFactory::createPattern(Uint mask) {
      pattern.clear();
      std::map<Uint, Uint>::const_iterator temp = pattern_template_map->find(mask);
      if (temp != pattern_template_map->end()) {
         /**/
         // DEBUG
         if (mask == 9)
            cout << "\nPattern: 2A (mask: " << mask << ")";
         if (mask == 10)
            cout << "\nPattern: 2B (mask: " << mask << ") (*)";
         if (mask == 65)
            cout << "\nPattern: 2C (mask: " << mask << ") (*)";
         if (mask == 11)
            cout << "\nPattern: 3A (mask: " << mask << ")";
         if (mask == 73 || mask == 81)
            cout << "\nPattern: 3B (mask: " << mask << ")";
         if (mask == 88)
            cout << "\nPattern: 3C (mask: " << mask << ") (*)";
         if (mask == 15)
            cout << "\nPattern: 4A (mask: " << mask << ")";
         if (mask == 27 || mask == 141)
            cout << "\nPattern: 4B (mask: " << mask << ")";
         if (mask == 139 || mask == 77)
            cout << "\nPattern: 4C (mask: " << mask << ")";
         if (mask == 29)
            cout << "\nPattern: 4Cb (mask: " << mask << ")";
         if (mask == 75 || mask == 149)
            cout << "\nPattern: 4D (mask: " << mask << ")";
         if (mask == 195 || mask == 85)
            cout << "\nPattern: 4E (mask: " << mask << ")";
         if (mask == 90)
            cout << "\nPattern: 4F (mask: " << mask << ") (*)";
         if (mask == 31 || mask == 205)
            cout << "\nPattern: 5A (mask: " << mask << ")";
         if (mask == 93)
            cout << "\nPattern: 5B (mask: " << mask << ")";
         if (mask == 173)
            cout << "\nPattern: 5C (mask: " << mask << ")";
         if (mask == 221)
            cout << "\nPattern: 6A (mask: " << mask << ")";
         if (mask == 95)
            cout << "\nPattern: 6B (mask: " << mask << ")";
         if (mask == 235)
            cout << "\nPattern: 6C (mask: " << mask << ")";
         if (mask == 191)
            cout << "\nPattern: 7A (mask: " << mask << ")";
         if (mask == 255)
            cout << "\nPattern: 8A (mask: " << mask << ")";
         /**/

         const item* it = templates[temp->second].items;
         for (Uint j = 0; j < MAX_ELEMENTS; j++) {
            if (it->size == 0)
               break;
            pattern.push_back(vector<Uint>(it->points, it->points + it->size));
            it++;
         }
         return true;
      }
      return false;
   }

   void PatternFactory::getTemplateEdges(Uint mask, vector<vector<Uint>>& edges) {
      std::map<Uint, Uint>::const_iterator temp = pattern_template_map->find(mask);
      if (temp != pattern_template_map->end()) {
         map<Uint, vector<vector<Uint>>>::const_iterator et = template_edges_map.find(temp->second);
         if (et != template_edges_map.end()) {
            edges = et->second;
         }
      }
   }

   void PatternFactory::deleteInstance () {
      if (m_Instance) {
         delete m_Instance;
         m_Instance = NULL;
      }
   }

   PatternFactory* PatternFactory::instance() {
      if (!m_Instance)
         m_Instance = new PatternFactory();
      else
         cout << "INSTANCE ALREADY CREATED" << endl;
      //m_NumInstances++;
      return m_Instance;
   }

}

